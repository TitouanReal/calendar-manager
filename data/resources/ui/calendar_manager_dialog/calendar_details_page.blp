using Gtk 4.0;
using Adw 1;

template $CalendarDetailsPage: Adw.NavigationPage {
  title: bind template.calendar as <$Calendar>.name;

  child: Adw.ToolbarView {
    [top]
    Adw.HeaderBar {}

    content: Adw.PreferencesPage {
      Adw.PreferencesGroup {
        Adw.EntryRow name_entry {
          title: _("Name");
          show-apply-button: true;
          apply => $update_calendar_name(template);
        }

        Adw.ActionRow {
          title: _("Color");
          activatable-widget: calendar_color_button;

          ColorDialogButton calendar_color_button {
            valign: center;
            // TODO: Find a way to skip the color update on page creation
            rgba: bind template.calendar as <$Calendar>.color;
            notify::rgba => $update_calendar_color(template);

            dialog: ColorDialog {
              modal: true;
              with-alpha: false;
            };
          }
        }
      }

      Adw.PreferencesGroup {
        Adw.ButtonRow {
          title: _("Delete Calendar");
          activated => $delete_calendar(template);

          styles [
            "destructive-action",
          ]
        }
      }
    };
  };
}
